{
  "version": 3,
  "sources": ["../../../../../apps/document_manager/document_manager/public/js/document.bundle.js"],
  "sourcesContent": ["\nfrappe.provide(\"document\");\nfunction attachment_uploaded(attachment, frm) {\n    if (this.dialog) {\n        this.dialog.hide();\n    }\n    update_attachment(attachment, frm);\n    frm.sidebar.reload_docinfo();\n    frm.refresh();\n    if (frm.doc.attachments) {\n        frm.doc.attachments.push(attachment);\n        frm.refresh_field('attachments');\n    }\n}\n\nfunction update_attachment(attachment, frm) {\n    if (attachment.name) {\n        add_to_attachments(attachment, frm);\n        frm.refresh();\n    }\n}\n\nfunction add_to_attachments(attachment, frm) {\n    var form_attachments = get_attachments(frm);\n    for (var i in form_attachments) {\n        if (form_attachments[i][\"name\"] === attachment.name) return;\n    }\n    form_attachments.push(attachment);\n}\n\nfunction get_attachments(frm) {\n    return frm.get_docinfo().attachments || [];\n}\ndocument.fetchFileNames = function(frm){\n    return new Promise((resolve, reject) => {\n        frappe.call({\n                method:\"document_manager.document_manager.apis.get_not_uploaded_documents\",\n                args:{\n                    \"doctype\":frm.doc.doctype,\n                    \"docname\":frm.doc.name,\n                }\n            }).then((res)=>{\n                if(res.message){\n                    let fileNames = res.message.map(ele => ele.name);\n                    resolve(fileNames);\n                }\n            })\n    })\n}\n\nfunction renderFileCard(d,frm){\n    frappe.call({\n        method:\"document_manager.document_manager.apis.get_all_documents_for_transection\",\n        args:{\n            \"doctype\":frm.doc.doctype,\n            \"docname\":frm.doc.name,\n        }\n    }).then((res)=>{\n        const documents = res.message[0]\n        const otherFiles = res.message[1]\n        const htmlContent = `\n        <head>\n            <style>\n                .contentcard { display: flex;flex-wrap: wrap;width: 100%;padding: 15px;justify-content: flex-end;background-color: #f3f3f350;border-radius: 8px;flex-direction: row-reverse;}\n                .item { display: flex;align-items: center;width: calc(93% / 3);margin-bottom: 10px;font-size: 13px;}\n                .circle {width: 12px;height: 12px;border-radius: 50%;margin-right: 10px;}\n                .greendashbord { background-color: #30a66d; }\n                .reddashbord { background-color:#cc2929; }\n                .yellowdashbord { background-color: #f5e171; }\n            </style>\n        </head>\n        <div class=\"contentcard\">\n            ${documents.map((ele)=>`<div class=\"item\"><div class=\"circle ${ele.status == \"R\" ? \"reddashbord\" :ele.status == \"Y\" ? \"yellowdashbord\" : \"greendashbord\"}\"></div>${ele.document_name}</div>`).join('')}\n        </div>`\n        const htmlContentOtherFile = `\n        <head>\n            <style>\n                .contentcard { display: flex;flex-wrap: wrap;width: 100%;padding: 15px;justify-content: flex-end;background-color: #f3f3f350;border-radius: 8px;flex-direction: row-reverse;}\n                .item { display: flex;align-items: center;width: calc(93% / 3);margin-bottom: 10px;font-size: 13px;}\n                .circle {width: 12px;height: 12px;border-radius: 50%;margin-right: 10px;}\n                .bluedashbord{ background-color: #0289f7; }\n            </style>\n        </head>\n        <div class=\"contentcard\">\n            ${otherFiles.map((ele)=>`<div class=\"item\"><div class=\"circle bluedashbord\"></div>${ele}</div>`).join('')}\n        </div>`\n        d.fields_dict['files_html'].$wrapper.html(htmlContent);\n        d.fields_dict['other_file_html'].$wrapper.html(htmlContentOtherFile);\n    })\n}\ndocument.openUploadDialog = function(frm,fileNames){\n    let d = new frappe.ui.Dialog({\n                title: 'Document Manager Uploader',\n                fields: [\n                    {   \n                        // label: 'Document Manager Uploaded Dashboard',\n                        fieldtype: \"HTML\",\n                        fieldname: 'footer_html',\n                        options: `\n                        <style>\n                            .circle {width: 10px;height: 10px;border-radius: 50%;margin-right: 10px;}\n                            .greendashbord { background-color: #30a66d;}\n                            .reddashbord { background-color:#cc2929;}\n                            .yellowdashbord { background-color: #f5e171;}\n                            .bluedashbord{ background-color: #0289f7;}\n                        </style>\n                        <div class=\"title_upload\" style=\"display:flex;justify-content: space-between;\">\n                            <div style=\"font-weight: 600;color:#383838;margin-bottom: 10px;\">Document Manager Dashboard</div>\n                            <div style=\"display:flex;color:#383838;font-size: 11px;\">\n                                <div style=\"display:flex;padding-right: 10px;\"><div class=\"circle reddashbord\" style=\"margin-right:3px;\"></div><div>Required</div></div>\n                                <div style=\"display:flex;padding-right: 10px;\"><div class=\"circle greendashbord\" style=\"margin-right:3px;\"></div><div>Uploaded</div></div>\n                                <div style=\"display:flex;padding-right: 10px;\"><div class=\"circle yellowdashbord\" style=\"margin-right:3px;\"></div><div>Optional</div></div>\n                                <div style=\"display:flex;\"><div class=\"circle bluedashbord\" style=\"margin-right:3px;\"></div><div>Another File</div></div>\n                            </div>\n                            \n                        </div>\n                        `,\n                    },\n                    {\n                        fieldtype: 'HTML',\n                        fieldname: 'files_html',\n                        options: ``,\n                    },\n                    {   \n                        label: 'Another Uploaded Document',\n                        fieldtype: \"Section Break\",\n                        hide_border:1\n                    },\n                    {\n                        fieldtype: 'HTML',\n                        fieldname: 'other_file_html',\n                        options: ``,\n                    },\n                    {   \n                        label: 'Select Document',\n                        fieldtype: \"Section Break\"\n                    },\n                    {\n                        label: 'Document Name',\n                        fieldname: 'file_name',\n                        fieldtype: 'Select',\n                        options:fileNames,\n                        onchange:()=>{\n                            // If you add another field edit fields[5]\n                            if(d.get_value(\"file_name\") == \"Upload Another Document\"){\n                                d.fields[7].hidden = 0;\n                            }\n                            else{\n                                d.fields[7].hidden = 1;\n                            }\n                            d.fields[8].hidden = 0;\n                            d.refresh();\n                        }\n                    },\n                    {\n                        label: 'Document Name for Another Attachment(Optional)',\n                        fieldname: 'att_name',\n                        fieldtype: 'Data',\n                        hidden:1,\n\n                    },\n                    {\n                        label: 'Upload',\n                        fieldname: 'file_upload',\n                        fieldtype: 'Button',\n                        click: () => {\n                            new frappe.ui.FileUploader({\n                                doctype: frm.doc.doctype,\n                                docname: frm.doc.name,\n                                frm: frm,\n                                folder: \"Home/Attachments\",\n                                allow_multiple:d.get_value(\"file_name\") ==\"Upload Another Document\"? true:false,\n                                on_success: (file_doc) => {\n                                    attachment_uploaded(file_doc, frm);\n                                    if (d.get_value(\"file_name\") != \"Upload Another Document\"){\n                                        frappe.db.set_value('File',file_doc.name,'custom_document_manager_doctype_detail_id', d.get_value(\"file_name\"))\n                                    }\n                                    else{\n                                        if(d.get_value(\"att_name\")){\n                                            frappe.db.set_value('File',file_doc.name,'custom_document_manager_doctype_detail_id',d.get_value(\"att_name\"))\n                                        }else{\n                                            frappe.db.set_value('File',file_doc.name,'custom_document_manager_doctype_detail_id',file_doc.file_name)\n                                        }\n                                        \n                                    }\n                                    d.hide()\n                                },\n                            });\n                        },\n                        hidden: 1,\n                    },\n                ],\n                size: 'large',\n            });\n            renderFileCard(d,frm);\n            d.show();\n}"],
  "mappings": "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",
  "names": []
}
